## HTML

###  meta属性

```html
// Android 禁止屏幕旋转
<meta name="screen-orientation" content="portrait"> 
// 全屏显示
<meta name="full-screen" content="yes">     
// UC应用模式，使用了application这种应用模式后，页面讲默认全屏，禁止长按菜单，禁止收拾，标准排版，以及强制图片显示。
<meta name="browsermode" content="application">     
// QQ强制竖屏
<meta name="x5-orientation" content="portrait">     
// QQ强制全屏
<meta name="x5-fullscreen" content="true">    
// QQ应用模式
<meta name="x5-page-mode" content="app">            
```

### 电话号码识别

在 iOS Safari （其他浏览器和 Android 均不会）上会对那些看起来像是电话号码的数字处理为电话链接，比如：

- 7 位数字，形如：1234567
- 带括号及加号的数字，形如：(+86)123456789
- 双连接线的数字，形如：00-00-00111
- 11 位数字，形如：13800138000

```html
// 关闭识别
<meta name="format-detection" content="telephone=no" />

// 开启识别
<a href="tel:123456">123456</a>
```

### 邮箱识别

```html
<meta content="email=no" name="format-detection" />

// 通过标签属性来开启长按邮箱地址弹出邮件发送
<a mailto:dooyoe@gmail.com">dooyoe@gmail.com</a>
```

## CSS

### 1px边框

一般采用伪元素模拟的方式，把原先元素的 border 去掉，然后利用 ：before 或者 ：after 重做 border，并缩小一半，原先的元素相对定位，新做的 border 绝对定位；

```css
.scale{
  position: relative;
  border:none;
}
.scale:after{
  content: '';
  position: absolute;
  bottom: 0;
  background: #000;
  width: 100%;
  height: 1px;
  transform: scaleY(0.5);
  transform-origin: 0 0;
}

// 使用box-shadow模拟边框
.box-shadow-1px {
  box-shadow: inset 0px -1px 1px -1px #c8c7cc;
}
```

### 清除输入框内阴影

在 iOS 上，输入框默认有内部阴影：

```css
div {
  -webkit-appearance: none;
}
```

### 禁止保存或拷贝图像

```css
img {
  -webkit-touch-callout: none;
}
```

### 输入框默认字体颜色

```javascript
input::-webkit-input-placeholder,
textarea::-webkit-input-placeholder {
  color: #c7c7c7;
}
input:-moz-placeholder,
textarea:-moz-placeholder {
  color: #c7c7c7;
}
input:-ms-input-placeholder,
textarea:-ms-input-placeholder {
  color: #c7c7c7;
}
```

### 字体禁止缩放

```css
body {
  -webkit-text-size-adjust: 100% !important;
  text-size-adjust: 100% !important;
  -moz-text-size-adjust: 100% !important;
}
```

### iOS 滑动不流畅

```
// 在滚动容器上增加滚动 touch 方法
.wrapper {
  -webkit-overflow-scrolling: touch;
}

// 设置 overflow 设置外部 overflow 为 hidden,设置内容元素 overflow 为 auto。内部元素超出 body 即产生滚动，超出的部分 body 隐藏
```

## JS

### click的延迟响应

> 双击缩放是产生 300ms 延迟的根源；

1. fastclick可以解决在手机上点击事件的300ms延迟；
   - fastckick 是一个轻量级的库；
   - fastckick 的实现原理是在检测到 tochend 事件的时候通过 DOM 自定义事件立即发出模拟一个 click 事件，并把浏览器在 300ms 之后的 click 事件阻止掉；
2. zepto 的 touch 模块，tap 事件也是为了解决在 click 的延迟问题；

触摸事件的响应顺序：

1. ontouchstart
2. ontouchmove
3. ontouchend
4. onclick

### 音频自动播放

由于自动播放网页中的音频或视频，会给用户带来一些困扰或者不必要的流量消耗，所以苹果系统和安卓系统通常都会禁止自动播放和使用 JS 的触发播放，必须由用户来触发才可以播放；

```javascript
$('html').one('touchstart', function() {
  audio.play()
})
```

### ios上/下拉边界出现空白

在 iOS 中，手指按住屏幕上下拖动会触发 touchmove 事件，这个事件触发的对象是整个 webview 容器，容器自然会被拖动，剩下的部分会成空白；

```javascript
document.body.addEventListener(
  'touchmove',
  function(e) {
    if (e._isScroller) return
    // 阻止默认事件
    e.preventDefault()
  },
  {
    passive: false
  }
)
```

## 软键盘问题

### 键盘弹起挡住原来的视图

> 可以通过监听移动端软键盘弹起；

Element.scrollIntoViewIfNeeded（Boolean）方法用来将不在浏览器窗口的可见区域内的元素滚动到浏览器窗口的可见区域。 如果该元素已经在浏览器窗口的可见区域内，则不会发生滚动；

- true，则元素将在其所在滚动区的可视区域中居中对齐；
- false，则元素将与其所在滚动区的可视区域最近的边缘对齐；根据可见区域最靠近元素的哪个边缘，元素的顶部将与可见区域的顶部边缘对准，或者元素的底部边缘将与可见区域的底部边缘对准；

```javascript
window.addEventListener('resize', function() {
  if (
    document.activeElement.tagName === 'INPUT' ||
    document.activeElement.tagName === 'TEXTAREA'
  ) {
    window.setTimeout(function() {
      if ('scrollIntoView' in document.activeElement) {
        document.activeElement.scrollIntoView(false)
      } else {
        document.activeElement.scrollIntoViewIfNeeded(false)
      }
    }, 0)
  }
})
```

### 键盘收起页面没回落留白

> 通过监听键盘回落时间滚动到原来的位置；

```javascript
window.addEventListener('focusout', function() {
  window.scrollTo(0, 0)
})

//input输入框弹起软键盘的解决方案。
var bfscrolltop = document.body.scrollTop
$('input')
  .focus(function() {
    document.body.scrollTop = document.body.scrollHeight
  })
  .blur(function() {
    document.body.scrollTop = bfscrolltop
  })
```

### fixed失效

软键盘唤起后，页面的 fixed 元素将失效变成了 absolute，所以当页面超过一屏且滚动时，失效的 fixed 元素就会跟随滚动了；

```css
<body>
  <div class='warper'>
    <div class='main'></div>
  <div>
  <div class="fix-bottom"></div>
</body>

 /* 不让页面滚动，而是让主体部分自己滚动,主体部分高度设为 100%，overflow:scroll */
.warper {
  position: absolute;
  width: 100%;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  overflow-y: scroll; /* 解决ios滑动不流畅问题 */
}
.fix-bottom {
  position: fixed;
  bottom: 0;
  width: 100%;
}
```

## 图片生成

- 营销场景和裂变过程中，需要将页面内容一部分作为图片整体分享出去，可以使用 html2Canvas 这个插件；
- 如果只是简单的二维码加海报图，可以用 canvas drawImage() 方法；

### 图片跨域

1. html2canvas 提供的 proxy 方案：

   ```javascript
   await html2canvas(eleImgBox, {
     // 前提是请求的图片本身是支持跨域请求的（可能需要后端设置）
     proxy: 'https://aliyun-oss.61info.cn'
   })
   ```

2. nginx 做域名转发；

3. 二维码这种，可以考虑base64格式的图片；