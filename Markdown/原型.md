## prototype 和 **proto**

- 一个 function 被 new 了我们认为它就是一个构造函数，通过 new 得到的东西就是一个实例。
- 每个 function 都有一个 prototype 属性，prototype 指向原型。
- prototype 上有 constructor 属性，constructor 指向构造函数（这个函数本身）。
- 每个实例都有一个 **proto** 属性，**proto** 指向构造函数的原型。
- 实例对象继承自这个构造函数的原型，原型上的属性和方法是被他的所有实例对象所拥有的。

```javascript
obj.__proto__ === fun.prototype
fun.prototype.constructor === fun
```

## new的本质

> 当一个函数被 new 了之后 this 会指向实例
>
> ```javascript
> function fun(){
>   this.a = 1
>   console.log(this, this.a)  
> }
> var obj = new fun() // obj 1
> ```

以 obj = new fun() 为例:

1. 首先 new 关键字会创建一个临时对象假设是 nsitObj，会把 nsitObj.**proto** 指向 fun.prototype 绑定原型;

2. 再把 fun 里面的 this 指向 nsitObj，并执行方法体。

3. 最后根据 fun 方法体的内容 return 回一个值，分为以下几种情况：

   - 如果fun方法体无返回值那么 new 关键字会 return 回 nsitObj，也就是说 obj 其实就是 nsitObj。
   - 如果fun方法体返回了以下任意类型的一种值 new 会无视返回值依然 return 回 nsitObj。 Number、 String、 Boolean、 undefined、 NaN、 Null
   - 如果fun方法体返回了一个 Function 那么 new 关节字会 return 回这个 function。
   - 如果fun方法体返回了一个用户自定义的 object 比如说一个空对象{}，那么 new 关节字会 return 回这个 object。

   ​